<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="tensorflow," />





  <link rel="alternate" href="/atom.xml" title="AI-Fundamental" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="View on Pages (Directly click the title) View on Jupyter Notebook   Download Jupyter Notebook">
<meta name="keywords" content="tensorflow">
<meta property="og:type" content="article">
<meta property="og:title" content="Programming 1 on Learning">
<meta property="og:url" content="https://ai-fundamental.github.io/2018/Programming 1 on Learning/index.html">
<meta property="og:site_name" content="AI-Fundamental">
<meta property="og:description" content="View on Pages (Directly click the title) View on Jupyter Notebook   Download Jupyter Notebook">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://ai-fundamental.github.io/assets/output_9_0.png">
<meta property="og:image" content="https://ai-fundamental.github.io/assets/output_9_2.png">
<meta property="og:image" content="https://ai-fundamental.github.io/assets/output_9_4.png">
<meta property="og:image" content="https://ai-fundamental.github.io/assets/output_9_6.png">
<meta property="og:image" content="https://ai-fundamental.github.io/assets/output_9_8.png">
<meta property="og:updated_time" content="2018-11-29T03:06:29.084Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Programming 1 on Learning">
<meta name="twitter:description" content="View on Pages (Directly click the title) View on Jupyter Notebook   Download Jupyter Notebook">
<meta name="twitter:image" content="https://ai-fundamental.github.io/assets/output_9_0.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":true,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://ai-fundamental.github.io/2018/Programming 1 on Learning/"/>





  <title>Programming 1 on Learning | AI-Fundamental</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">AI-Fundamental</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Learning AI is not so hard.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://ai-fundamental.github.io/2018/Programming 1 on Learning/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ping Luo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/ping.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AI-Fundamental">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Programming 1 on Learning</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-19T16:00:00+08:00">
                2018-10-19
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/Programming 1 on Learning/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2018/Programming 1 on Learning/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <ul>
<li>View on Pages (Directly click the title)</li>
<li>View on <a href="/assets/CDTensorflow.html">Jupyter Notebook</a>  </li>
<li>Download <a href="/assets/CDTensorflow.ipynb">Jupyter Notebook</a>  </li>
</ul>
<a id="more"></a>
<h3 id="Import-packages"><a href="#Import-packages" class="headerlink" title="Import packages"></a>Import packages</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># coding: utf-8</span></div><div class="line"><span class="comment"># ============================================================================</span></div><div class="line"><span class="comment">#   Copyright (C) 2017 All rights reserved.</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment">#   filename : Logistic_Regression.py</span></div><div class="line"><span class="comment">#   author   : chendian / okcd00@qq.com</span></div><div class="line"><span class="comment">#   date     : 2018-09-26</span></div><div class="line"><span class="comment">#   desc     : Tensorflow Logistic Regression Tutorial</span></div><div class="line"><span class="comment">#   </span></div><div class="line"><span class="comment"># ============================================================================</span></div><div class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</div><div class="line"><span class="keyword">import</span> os</div><div class="line">os.environ[<span class="string">"CUDA_VISIBLE_DEVICES"</span>] = <span class="string">""</span></div><div class="line"><span class="comment"># jupyter notebook</span></div><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">import</span> math</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div></pre></td></tr></table></figure>
<h3 id="Loading-training-data-from-sklearn"><a href="#Loading-training-data-from-sklearn" class="headerlink" title="Loading training data from sklearn"></a>Loading training data from sklearn</h3><blockquote>
<p>如果需要使用 sklearn 第三方库中自带的数据集，这里我列出了三种，方便调用与测试</p>
</blockquote>
<p><strong>sklearn的安装</strong><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip install sklearn</div></pre></td></tr></table></figure></p>
<p><strong>调用方法</strong></p>
<ul>
<li>data = load_data(name=’moons’)</li>
<li>data = load_data(name=’circles’)</li>
<li>data = load_data(name=’linear’)</li>
</ul>
<p>如果安装sklearn有困难，也可以直接从文件读取：</p>
<ul>
<li>data = load_data(name=’moons’, True)</li>
<li>data = load_data(name=’circles’, True)</li>
<li>data = load_data(name=’linear’, True)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># use data from sklearn package</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_moons</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_moons</div><div class="line">    np.random.seed(<span class="number">0</span>)</div><div class="line">    X, y = make_moons(<span class="number">800</span>, noise=<span class="number">0.2</span>)</div><div class="line">    <span class="keyword">print</span> (<span class="string">"dataset shape:"</span>, X.shape)</div><div class="line">    </div><div class="line">    <span class="comment"># return train validate test sets </span></div><div class="line">    <span class="keyword">return</span> [(X[<span class="number">0</span>:<span class="number">600</span>,],y[<span class="number">0</span>:<span class="number">600</span>,]), (X[<span class="number">600</span>:<span class="number">800</span>,],y[<span class="number">600</span>:<span class="number">800</span>,])]</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_circles</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_circles</div><div class="line">    np.random.seed(<span class="number">0</span>)</div><div class="line">    X, y = make_circles(<span class="number">800</span>, noise=<span class="number">0.2</span>, factor=<span class="number">0.5</span>, random_state=<span class="number">2</span>)</div><div class="line">    <span class="keyword">print</span> (<span class="string">"dataset shape:"</span>, X.shape)</div><div class="line">    </div><div class="line">    <span class="comment"># return train validate test sets </span></div><div class="line">    <span class="keyword">return</span> [(X[<span class="number">0</span>:<span class="number">600</span>,],y[<span class="number">0</span>:<span class="number">600</span>,]), (X[<span class="number">600</span>:<span class="number">800</span>,],y[<span class="number">600</span>:<span class="number">800</span>,])]</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_linear</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_classification</div><div class="line">    np.random.seed(<span class="number">0</span>)</div><div class="line">    X, y = make_classification(</div><div class="line">        <span class="number">800</span>, n_features=<span class="number">2</span>, n_redundant=<span class="number">0</span>, n_informative=<span class="number">1</span>,</div><div class="line">        random_state=<span class="number">1</span>, n_clusters_per_class=<span class="number">1</span>)</div><div class="line">    <span class="keyword">print</span> (<span class="string">"dataset shape:"</span>, X.shape)</div><div class="line">    </div><div class="line">    <span class="comment"># return train validate test sets </span></div><div class="line">    <span class="keyword">return</span> [(X[<span class="number">0</span>:<span class="number">600</span>,],y[<span class="number">0</span>:<span class="number">600</span>,]), (X[<span class="number">600</span>:<span class="number">800</span>,],y[<span class="number">600</span>:<span class="number">800</span>,])]</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_data</span><span class="params">(name=<span class="string">'moons'</span>, load_directly=False)</span>:</span></div><div class="line">    _datasets=&#123;</div><div class="line">        <span class="string">'moons'</span>: load_moons,</div><div class="line">        <span class="string">'linear'</span>: load_linear,</div><div class="line">        <span class="string">'circles'</span>: load_circles,</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        ret = pickle.load(open(<span class="string">'./&#123;&#125;.pkl'</span>.format(name), <span class="string">'r'</span>)) <span class="keyword">if</span> load_directly <span class="keyword">else</span> _datasets[name]()</div><div class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</div><div class="line">        print(<span class="string">"set name as 'moons', 'linear' or 'circles',\n or check your files' existence"</span>)</div><div class="line">        print(e)</div><div class="line">    <span class="keyword">return</span> ret</div></pre></td></tr></table></figure>
<h3 id="Define-network"><a href="#Define-network" class="headerlink" title="Define network"></a>Define network</h3><blockquote>
<p>此处给出的是逻辑回归(Logistic Regression)的神经网络结构</p>
</blockquote>
<p>对于输入向量x，其属于类别i的概率为：<br>$$\begin{align<em>}<br>P\left ( Y=i\mid x,W,b \right ) &amp;=softmax_i\left ( Wx+b \right ) \<br> &amp;= \frac{e^{W_ix+b<em>i}}{\sum</em>{j}e^{W_jx+b_j}}<br>\end{align</em>}$$</p>
<p>模型对于输入向量x的预测结果y<em>pred是所有类别的预测中概率值最大的，即<br>$$y</em>{pred}=argmax_iP\left ( Y=i\mid x,W,b \right )$$</p>
<p>在LR模型中，需要求解的参数为权重矩阵W和偏置向量b，为了求解模型的两个参数，首先必须定义损失函数。对于上述的多类别Logistic回归，可以藉由Log似然函数作为其损失函数（<strong>负对数似然</strong> 注意取负）：<br>$$L\left ( \theta =\left { W,b \right },D \right )=\sum_{i=0}^{\left | D \right |}log\left ( P\left ( Y=y^{\left ( i \right )}\mid x^{\left ( i \right )},W,b  \right ) \right )$$</p>
<p>P.S. 代码中使用的<code>softmax_cross_entropy(y_truth, logits)</code>效果为:<br>先将<code>logits</code>作<code>softmax</code>操作获得<code>y_pred</code>，然后使用<code>y_truth</code>和<code>y_pred</code>作负对数似然。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">LogisticRegression</span><span class="params">()</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, n_in, n_out)</span>:</span></div><div class="line">        self.X = tf.placeholder(tf.float32, [<span class="keyword">None</span>, n_in], name=<span class="string">'X'</span>)</div><div class="line">        self.y = tf.placeholder(tf.int32, [<span class="keyword">None</span>], name=<span class="string">'y'</span>)</div><div class="line">        self.init_variables(n_in, n_out)</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">init_variables</span><span class="params">(self, n_in, n_out)</span>:</span></div><div class="line">        <span class="comment"># n_in means n_features</span></div><div class="line">        <span class="comment"># n_out means n_classes</span></div><div class="line">        self.W = tf.Variable(</div><div class="line">            initial_value=tf.constant(<span class="number">0.0</span>, shape=[n_in, n_out]),</div><div class="line">            dtype=tf.float32, name=<span class="string">'weight'</span>)</div><div class="line">        self.b = tf.Variable(</div><div class="line">            initial_value=tf.constant(<span class="number">0.0</span>, shape=[n_out]),</div><div class="line">            dtype=tf.float32, name=<span class="string">'bias'</span>)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">softmax</span><span class="params">(self, logits)</span>:</span></div><div class="line">        <span class="comment"># softmax = tf.exp(logits) / tf.reduce_sum(tf.exp(logits), axis)</span></div><div class="line">        <span class="keyword">return</span> tf.nn.softmax(logits, <span class="number">-1</span>)</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">negative_log_likelihood</span><span class="params">(self, y_pred, y)</span>:</span></div><div class="line">        prob = self.sigmoid(y_pred)</div><div class="line">        positive_likelihood = tf.log(prob) * y.reshape(<span class="number">-1</span>, <span class="number">1</span>)</div><div class="line">        negative_likelihood = tf.log(<span class="number">1</span> - prob) * (<span class="number">1</span> - y.reshape(<span class="number">-1</span>, <span class="number">1</span>))</div><div class="line">        log_likelihood = positive_likelihood + negative_likelihood</div><div class="line">        <span class="keyword">return</span> -tf.reduce_mean(log_likelihood)</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_network</span><span class="params">(self)</span>:</span></div><div class="line">        hidden = tf.matmul(self.X, self.W) + self.b</div><div class="line">        self.y_pred = tf.argmax(self.softmax(hidden), axis=<span class="number">-1</span>)  </div><div class="line">        <span class="keyword">return</span> self.y_pred, hidden</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_loss</span><span class="params">(self, hidden)</span>:</span></div><div class="line">        <span class="comment"># self.loss = self.negative_log_likelihood(y_pred, y)</span></div><div class="line">        <span class="comment"># self.loss = tf.nn.sigmoid_cross_entropy_with_logits(y_pred, y)</span></div><div class="line">        onehot_labels = tf.one_hot(self.y, depth=<span class="number">2</span>)</div><div class="line">        self.loss = tf.losses.softmax_cross_entropy(onehot_labels=onehot_labels, logits=hidden)</div><div class="line">        <span class="keyword">return</span> tf.reduce_mean(self.loss)</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gen_input</span><span class="params">(self, data_x, data_y=None)</span>:</span></div><div class="line">        feed_dict = &#123;&#125;</div><div class="line">        feed_dict[self.X] = data_x</div><div class="line">        <span class="keyword">if</span> data_y <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:    </div><div class="line">            self.y_truth = data_y</div><div class="line">            feed_dict[self.y] = data_y</div><div class="line">        <span class="keyword">return</span> feed_dict</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">errors</span><span class="params">(self, y_pred, y_truth=None)</span>:</span></div><div class="line">        <span class="keyword">if</span> y_truth <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            y_truth = self.y</div><div class="line">            not_equal_counts = tf.abs(y_pred - y_truth)</div><div class="line">            <span class="keyword">return</span> tf.reduce_mean(not_equal_counts)</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            not_equal_counts = abs(y_pred - y_truth)</div><div class="line">            <span class="keyword">return</span> np.mean(not_equal_counts)</div></pre></td></tr></table></figure>
<h3 id="Define-optimizer"><a href="#Define-optimizer" class="headerlink" title="Define optimizer"></a>Define optimizer</h3><blockquote>
<p>因为深度学习常见的是对于梯度的优化，也就是说，<br>优化器最后其实就是各种对于梯度下降算法的优化。</p>
</blockquote>
<p>常见的优化器有 SGD，RMSprop，Adagrad，Adadelta，Adam 等，<br>此处实例中使用的是随机梯度下降（Stochastic gradient descent），<br>因为大多数机器学习任务就是最小化损失，在损失定义的情况下，后面的工作就交给优化器处理即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sgd_optimization</span><span class="params">(datasets, learning_rate=<span class="number">0.10</span>, n_epochs=<span class="number">50</span>, draw_freq=<span class="number">10</span>)</span>:</span></div><div class="line">    train_set_x, train_set_y = datasets[<span class="number">0</span>]</div><div class="line">    test_set_x,  test_set_y  = datasets[<span class="number">1</span>]</div><div class="line">    classifier = LogisticRegression(n_in=<span class="number">2</span>, n_out=<span class="number">2</span>)  <span class="comment"># Classifier</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_model_train</span><span class="params">()</span>:</span></div><div class="line">        <span class="keyword">with</span> tf.name_scope(<span class="string">'train'</span>):</div><div class="line">            y_pred, hidden = classifier.get_network()</div><div class="line">            loss = classifier.get_loss(hidden)</div><div class="line">            <span class="keyword">return</span> y_pred, loss</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_model_test</span><span class="params">()</span>:</span></div><div class="line">        <span class="keyword">with</span> tf.name_scope(<span class="string">'test'</span>):</div><div class="line">            y_pred, hidden = classifier.get_network()</div><div class="line">            <span class="keyword">return</span> y_pred</div><div class="line">        </div><div class="line">    train_output = get_model_train()  <span class="comment"># y_pred, loss</span></div><div class="line">    test_output = get_model_test()  <span class="comment"># y_pred</span></div><div class="line">    optimizer = tf.train.GradientDescentOptimizer(learning_rate).minimize(train_output[<span class="number">-1</span>])</div><div class="line">    </div><div class="line">    init = tf.global_variables_initializer()</div><div class="line">    sess = tf.Session()</div><div class="line">    sess.run(init)</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">call_model</span><span class="params">(data_x, data_y=None, name=None)</span>:</span></div><div class="line">        <span class="comment"># generate data_y for placeholder while testing</span></div><div class="line">        <span class="keyword">if</span> data_y <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            data_y = np.zeros(data_x.shape[:<span class="number">-1</span>])</div><div class="line">            </div><div class="line">        <span class="keyword">if</span> name == <span class="string">'test'</span>:</div><div class="line">            ret = sess.run(  <span class="comment"># return y_pred</span></div><div class="line">                test_output,</div><div class="line">                feed_dict=classifier.gen_input(data_x, data_y))</div><div class="line">        <span class="keyword">else</span>:  <span class="comment"># name == 'train'</span></div><div class="line">            _, ret = sess.run(  <span class="comment"># return y_pred, loss</span></div><div class="line">                [optimizer, train_output], </div><div class="line">                feed_dict=classifier.gen_input(data_x, data_y))</div><div class="line">        <span class="keyword">return</span> ret</div><div class="line">    </div><div class="line">    epoch = <span class="number">0</span></div><div class="line">    <span class="keyword">while</span> epoch &lt; n_epochs:</div><div class="line">        <span class="comment"># draw a figure every 'draw_freq' times</span></div><div class="line">        <span class="keyword">if</span> epoch % draw_freq == <span class="number">0</span>:</div><div class="line">            <span class="comment"># print(train_set_x, train_set_y)</span></div><div class="line">            plot_decision_boundary(</div><div class="line">                <span class="keyword">lambda</span> x: call_model(x)[<span class="number">0</span>], </div><div class="line">                train_set_x, train_set_y)</div><div class="line">        </div><div class="line">        <span class="comment"># print error/cost per epoch</span></div><div class="line">        train_pred, loss = call_model(</div><div class="line">            train_set_x, train_set_y, <span class="string">'train'</span>)</div><div class="line">        train_error = classifier.errors(</div><div class="line">            y_pred=train_pred, y_truth=train_set_y)</div><div class="line">        </div><div class="line">        test_pred = call_model(</div><div class="line">            test_set_x,  test_set_y, <span class="string">'test'</span>)</div><div class="line">        test_error = classifier.errors(</div><div class="line">            y_pred=test_pred, y_truth=test_set_y)</div><div class="line"></div><div class="line">        <span class="keyword">print</span> (<span class="string">"epoch is %d, train error %f, test error %f"</span> % (</div><div class="line">            epoch, train_error, test_error))</div><div class="line">        epoch += <span class="number">1</span></div><div class="line"></div><div class="line">    <span class="comment"># draw a figure at last        </span></div><div class="line">    plot_decision_boundary(</div><div class="line">        <span class="keyword">lambda</span> x: call_model(x)[<span class="number">0</span>], </div><div class="line">        train_set_x, train_set_y)</div><div class="line">    sess.close()</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_decision_boundary</span><span class="params">(pred_func, train_set_x, train_set_y)</span>:</span></div><div class="line">    <span class="comment"># Draw figures as Matlab </span></div><div class="line">    x_min, x_max = train_set_x[:, <span class="number">0</span>].min() - <span class="number">.5</span>, train_set_x[:, <span class="number">0</span>].max() + <span class="number">.5</span></div><div class="line">    y_min, y_max = train_set_x[:, <span class="number">1</span>].min() - <span class="number">.5</span>, train_set_x[:, <span class="number">1</span>].max() + <span class="number">.5</span></div><div class="line">    h = <span class="number">0.01</span></div><div class="line">    xx, yy = np.meshgrid(np.arange(x_min, x_max, h), np.arange(y_min, y_max, h))</div><div class="line">    grid_input = np.c_[xx.ravel(), yy.ravel()].reshape([<span class="number">-1</span>, <span class="number">2</span>])</div><div class="line">    Z = pred_func(grid_input)</div><div class="line">    plt.contourf(xx, yy, Z.reshape(xx.shape), cmap=plt.cm.Spectral)</div><div class="line">    plt.scatter(train_set_x[:, <span class="number">0</span>], train_set_x[:, <span class="number">1</span>], c=train_set_y, cmap=plt.cm.Spectral)</div><div class="line">    plt.show()</div></pre></td></tr></table></figure>
<h3 id="Start-Training"><a href="#Start-Training" class="headerlink" title="Start Training"></a>Start Training</h3><blockquote>
<p>对于模型选择输入数据（data），设置参数（迭代次数，每N次绘制一次）</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pickle</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__==<span class="string">"__main__"</span>:</div><div class="line">    data = load_data(<span class="string">'moons'</span>, load_directly=<span class="keyword">True</span>)</div><div class="line">    sgd_optimization(data, learning_rate=<span class="number">0.1</span>, n_epochs=<span class="number">100</span>, draw_freq=<span class="number">25</span>)</div></pre></td></tr></table></figure>
<p><img src="/assets/output_9_0.png" alt="png"></p>
<pre><code>epoch is 0, train error 0.513333, test error 0.460000
epoch is 1, train error 0.513333, test error 0.165000
epoch is 2, train error 0.248333, test error 0.160000
epoch is 3, train error 0.201667, test error 0.175000
epoch is 4, train error 0.215000, test error 0.185000
epoch is 5, train error 0.206667, test error 0.185000
epoch is 6, train error 0.200000, test error 0.185000
epoch is 7, train error 0.200000, test error 0.185000
epoch is 8, train error 0.201667, test error 0.190000
epoch is 9, train error 0.203333, test error 0.190000
epoch is 10, train error 0.198333, test error 0.195000
epoch is 11, train error 0.198333, test error 0.195000
epoch is 12, train error 0.201667, test error 0.195000
epoch is 13, train error 0.201667, test error 0.195000
epoch is 14, train error 0.198333, test error 0.190000
epoch is 15, train error 0.198333, test error 0.190000
epoch is 16, train error 0.198333, test error 0.190000
epoch is 17, train error 0.195000, test error 0.190000
epoch is 18, train error 0.195000, test error 0.185000
epoch is 19, train error 0.195000, test error 0.185000
epoch is 20, train error 0.193333, test error 0.180000
epoch is 21, train error 0.191667, test error 0.180000
epoch is 22, train error 0.191667, test error 0.180000
epoch is 23, train error 0.191667, test error 0.180000
epoch is 24, train error 0.190000, test error 0.180000
</code></pre><p><img src="/assets/output_9_2.png" alt="png"></p>
<pre><code>epoch is 25, train error 0.191667, test error 0.175000
epoch is 26, train error 0.193333, test error 0.170000
epoch is 27, train error 0.193333, test error 0.170000
epoch is 28, train error 0.191667, test error 0.165000
epoch is 29, train error 0.191667, test error 0.165000
epoch is 30, train error 0.193333, test error 0.160000
epoch is 31, train error 0.193333, test error 0.160000
epoch is 32, train error 0.193333, test error 0.160000
epoch is 33, train error 0.193333, test error 0.160000
epoch is 34, train error 0.193333, test error 0.160000
epoch is 35, train error 0.193333, test error 0.160000
epoch is 36, train error 0.193333, test error 0.160000
epoch is 37, train error 0.195000, test error 0.160000
epoch is 38, train error 0.195000, test error 0.160000
epoch is 39, train error 0.195000, test error 0.155000
epoch is 40, train error 0.195000, test error 0.155000
epoch is 41, train error 0.195000, test error 0.155000
epoch is 42, train error 0.193333, test error 0.155000
epoch is 43, train error 0.190000, test error 0.160000
epoch is 44, train error 0.190000, test error 0.160000
epoch is 45, train error 0.188333, test error 0.160000
epoch is 46, train error 0.188333, test error 0.160000
epoch is 47, train error 0.188333, test error 0.155000
epoch is 48, train error 0.186667, test error 0.155000
epoch is 49, train error 0.186667, test error 0.155000
</code></pre><p><img src="/assets/output_9_4.png" alt="png"></p>
<pre><code>epoch is 50, train error 0.185000, test error 0.165000
epoch is 51, train error 0.185000, test error 0.160000
epoch is 52, train error 0.190000, test error 0.155000
epoch is 53, train error 0.188333, test error 0.155000
epoch is 54, train error 0.190000, test error 0.155000
epoch is 55, train error 0.190000, test error 0.155000
epoch is 56, train error 0.191667, test error 0.160000
epoch is 57, train error 0.190000, test error 0.160000
epoch is 58, train error 0.191667, test error 0.155000
epoch is 59, train error 0.191667, test error 0.160000
epoch is 60, train error 0.191667, test error 0.160000
epoch is 61, train error 0.190000, test error 0.155000
epoch is 62, train error 0.188333, test error 0.155000
epoch is 63, train error 0.188333, test error 0.155000
epoch is 64, train error 0.188333, test error 0.155000
epoch is 65, train error 0.188333, test error 0.155000
epoch is 66, train error 0.188333, test error 0.155000
epoch is 67, train error 0.188333, test error 0.155000
epoch is 68, train error 0.188333, test error 0.155000
epoch is 69, train error 0.186667, test error 0.155000
epoch is 70, train error 0.185000, test error 0.155000
epoch is 71, train error 0.185000, test error 0.155000
epoch is 72, train error 0.183333, test error 0.155000
epoch is 73, train error 0.181667, test error 0.155000
epoch is 74, train error 0.181667, test error 0.155000
</code></pre><p><img src="/assets/output_9_6.png" alt="png"></p>
<pre><code>epoch is 75, train error 0.181667, test error 0.155000
epoch is 76, train error 0.183333, test error 0.145000
epoch is 77, train error 0.183333, test error 0.145000
epoch is 78, train error 0.185000, test error 0.150000
epoch is 79, train error 0.185000, test error 0.150000
epoch is 80, train error 0.183333, test error 0.150000
epoch is 81, train error 0.183333, test error 0.150000
epoch is 82, train error 0.183333, test error 0.150000
epoch is 83, train error 0.181667, test error 0.150000
epoch is 84, train error 0.181667, test error 0.150000
epoch is 85, train error 0.181667, test error 0.150000
epoch is 86, train error 0.181667, test error 0.150000
epoch is 87, train error 0.180000, test error 0.150000
epoch is 88, train error 0.180000, test error 0.150000
epoch is 89, train error 0.180000, test error 0.150000
epoch is 90, train error 0.180000, test error 0.150000
epoch is 91, train error 0.178333, test error 0.150000
epoch is 92, train error 0.178333, test error 0.150000
epoch is 93, train error 0.180000, test error 0.150000
epoch is 94, train error 0.176667, test error 0.150000
epoch is 95, train error 0.176667, test error 0.145000
epoch is 96, train error 0.176667, test error 0.145000
epoch is 97, train error 0.176667, test error 0.145000
epoch is 98, train error 0.175000, test error 0.145000
epoch is 99, train error 0.175000, test error 0.145000
</code></pre><p><img src="/assets/output_9_8.png" alt="png"></p>
<h3 id="Course-Testing"><a href="#Course-Testing" class="headerlink" title="Course Testing"></a>Course Testing</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">a, b = [<span class="number">1</span>,<span class="number">2</span>]</div><div class="line">a, b</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> os</div><div class="line">os.environ[<span class="string">"CUDA_VISIBLE_DEVICES"</span>] = <span class="string">""</span></div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</div></pre></td></tr></table></figure>
<h3 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Step 1: placeholder</span></div><div class="line">x = tf.placeholder(tf.float32, [<span class="keyword">None</span>, <span class="number">2</span>], name=<span class="string">'x'</span>)</div><div class="line">y = tf.placeholder(tf.float32, [<span class="keyword">None</span>, <span class="number">2</span>], name=<span class="string">'y'</span>)</div><div class="line"></div><div class="line"><span class="comment"># Step 2: network</span></div><div class="line">output = x * y</div><div class="line"></div><div class="line"><span class="comment"># Step 3: prepare data</span></div><div class="line">data_x = np.random.rand(<span class="number">8</span>).reshape([<span class="number">4</span>,<span class="number">2</span>])</div><div class="line">data_y = np.arange(<span class="number">8</span>).reshape([<span class="number">4</span>,<span class="number">2</span>]).astype(np.int32)</div><div class="line"></div><div class="line"><span class="comment"># Step 4: run</span></div><div class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</div><div class="line">    output = sess.run(</div><div class="line">        [output],</div><div class="line">        feed_dict = &#123;x: data_x, y: data_y&#125;</div><div class="line">    )</div><div class="line">    print(output)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</div><div class="line">a = tf.eye(<span class="number">3</span> ,name=<span class="string">'a'</span>)</div><div class="line">b = tf.ones(<span class="number">3</span>, name=<span class="string">'b'</span>)</div><div class="line">c = tf.zeros([<span class="number">5</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>], dtype=tf.int32, name=<span class="string">'c'</span>)</div><div class="line">d = tf.reshape(tf.range(<span class="number">60</span>), [<span class="number">5</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>], name=<span class="string">'d'</span>)</div><div class="line">e = tf.constant([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>], name=<span class="string">'e'</span>)</div><div class="line">f = tf.matmul(c, d)</div><div class="line">var = [a,b,c,d,e,f]</div><div class="line"></div><div class="line">sess = tf.Session()</div><div class="line">output = sess.run(</div><div class="line">    var,</div><div class="line">    <span class="comment"># feed_dict = &#123;x: np.ones(3)&#125;</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> zip(var, output):</div><div class="line">    print(k)</div><div class="line">    print(v)</div><div class="line">    print()</div><div class="line"></div><div class="line">sess.close()</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>

      
    </div>
    
    
    

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    Ping Luo
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://ai-fundamental.github.io/2018/Programming 1 on Learning/" title="Programming 1 on Learning">https://ai-fundamental.github.io/2018/Programming 1 on Learning/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/tensorflow/" rel="tag"># tensorflow</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/The knowledge graph of the second course part Knowledge/" rel="next" title="The knowledge graph of the second course part: Knowledge">
                <i class="fa fa-chevron-left"></i> The knowledge graph of the second course part: Knowledge
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/The knowledge graph of the third course part Learning/" rel="prev" title="The knowledge graph of the third course part: Learning">
                The knowledge graph of the third course part: Learning <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/assets/ping.jpg"
               alt="Ping Luo" />
          <p class="site-author-name" itemprop="name">Ping Luo</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="mailto:luop@ict.ac.cn" target="_blank" title="E-Mail">
                  
                    <i class="fa fa-fw fa-envelope-open"></i>
                  
                    
                      E-Mail
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://mldm.ict.ac.cn/MLDM/luoping/" target="_blank" title="About">
                  
                    <i class="fa fa-fw fa-user-circle-o"></i>
                  
                    
                      About
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://ai-fundamental.gitee.io/" target="_blank" title="Mirror">
                  
                    <i class="fa fa-fw fa-star-half-o"></i>
                  
                    
                      Mirror
                    
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Import-packages"><span class="nav-number">1.</span> <span class="nav-text">Import packages</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Loading-training-data-from-sklearn"><span class="nav-number">2.</span> <span class="nav-text">Loading training data from sklearn</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Define-network"><span class="nav-number">3.</span> <span class="nav-text">Define network</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Define-optimizer"><span class="nav-number">4.</span> <span class="nav-text">Define optimizer</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Start-Training"><span class="nav-number">5.</span> <span class="nav-text">Start Training</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Course-Testing"><span class="nav-number">6.</span> <span class="nav-text">Course Testing</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hello-World"><span class="nav-number">7.</span> <span class="nav-text">Hello World</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2017 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="author" itemprop="copyrightHolder"> <a href="http://mldm.ict.ac.cn/MLDM/luoping/">Ping Luo </a> </span>
  <span class="with-love">
    <i class="fa fa-star"></i>
  </span>
  <span class="deployer" > Deployed by student <a href="http://okcd00.github.io">Dian Chen</a></span>
</div>


<div class="powered-by">
  由 <a href="http://github.com/okcd00">okcd00</a> 部署 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  

    
      <script id="dsq-count-scr" src="https://okcd00.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'https://ai-fundamental.github.io/2018/Programming 1 on Learning/';
          this.page.identifier = '2018/Programming 1 on Learning/';
          this.page.title = 'Programming 1 on Learning';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://okcd00.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  








  





  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.2"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.2"></script>


  

</body>
</html>
